version: "3.7"
services:
    dashboard:
        image: phpmate
        volumes:
            - .:/var/www
        working_dir: /var/www/dashboard
        depends_on:
            - composer
        ports:
            - 8080:8080
        command: [ "php", "-S", "0.0.0.0:8080", "-t", "public" ]
        environment:
            APP_DEBUG: 1

    dashboard-symfony:
        image: phpmate
        volumes:
            - .:/var/www
        working_dir: /var/www/dashboard-symfony
        ports:
            - 8081:8080
        command: [ "php", "-S", "0.0.0.0:8080", "-t", "public" ]
        environment:
            APP_DEBUG: 1
            APP_ENV: dev

    php:
        image: phpmate
        volumes:
            - .:/var/www
        working_dir: /var/www
        depends_on:
            - composer

    composer:
        image: phpmate
        build:
            context: .
            target: dev
        volumes:
            - .:/var/www
        working_dir: /var/www
        entrypoint: "composer"
        command: [ "install", "--no-interaction" ]
